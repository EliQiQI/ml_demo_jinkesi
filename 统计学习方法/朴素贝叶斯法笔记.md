# 朴素贝叶斯法

贝叶斯公式

$$
P(Y_k | X) =\frac {P(X|Y_k)P(Y_k)}{\Sigma_k P(X | Y = Y_k)P(Y_k)}
$$

> 朴素贝叶斯算法假设所有特征的出现相互独立互不影响,每一特征同等重要,又因为其简单,而且具有很好的可解释性.相对于其他精心设计的更复杂的分类算法,朴素贝叶斯分类算法是学习效率和分类效果较好的分类器之一.朴素贝叶斯算法一般应用在文本分类,垃圾邮件的分类,信用评估,钓鱼网站检测等.


## 朴素贝叶斯算法

输入: 训练数据$T=\{(x_1,y_1),(x_2,y_2),...,(x_N,y_N)\}$,其中$x_i=(x_i^{(1)},x_i^{(2)},...,x_i^{(n)})^T$,$x_i^{(j)}$是第$i$个样本的第$j$个特征,$x_i^{(j)}\in\{a_{j1},a_{j2},...,a_{jS_j}\}$,$a_{jl}$是第j个特征可能取得第$l$个值,$j=1,2,...,n,l=1,2,...,S_j,y_l\in\{c_1,c_2,...,c_K\}$;实例$x$
输出:实例$x$的分类

(1)计算先验概率及条件概率

$$
P(Y=c_k) = \frac {\Sigma_{i=1}^N I(y_i=c_k)}{N},k=1,2,...,K
$$

$$
P(X^{(j)}=a_{jl}|Y=c_k) = \frac {\Sigma_{i=1}^{N}I(x_i^{(j)}=a_{jl},y_i=c_k)}{\Sigma_{i=1}^N I(y_i=c_k)}
$$

$$
j=1,2,...,n;l=1,2,...,S_j;k=1,2,...,K
$$

(2)对于给定的实例$x=(x^{(1)},x^{(2)},...,x^{(n)})^T$,计算

$$
P(Y=c_k)\prod_{j=1}^{n}P(X^{(j)}=x^{(j)}|Y=c_k),k=1,2,...,K
$$

(3)确定实例$x$的类

$$
y = arg {max}_{c_k}P(Y=c_k)\prod_{j=1}^{n}P(X^{(j)}=x^{(j)}| Y=c_k)
$$


## 贝叶斯估计

用极大似然估计可能会影响到后验概率的计算结果,使得分类产生偏差.解决这一问题的方法是采用贝叶斯估计.条件该老板的贝叶斯估计是

$$
P_{\lambda}(X^{(j)}=a_{jl}|Y=c_k) = \frac {\Sigma_{i=1}^N I(x_i^{j} = a_{jl},y_i=c_k)+\lambda} {\Sigma_{i=1}^N I(y_i=c_k)+S_j\lambda}
$$

式中$\lambda \geq 0.$等价于在随机变量各个取值的频数上赋予一个正数$\lambda > 0$.当$\lambda = 0 $时就是极大似然估计.常取$\lambda = 1$,这时称为拉普拉斯平滑.显然,对任何$l=1,2,...,S_j,k=1,2,...,K$,有

$$
P_{\lambda}(X^{(j)}=a_{jl}|Y=c_k) > 0
$$

$$
\Sigma_{l=1}^{S_j}P(X^{(j)}=a_{jl} | Y=c_k)=1
$$

同样,先验概率的贝叶斯估计是

$$
P_{\lambda}(Y=c_k) = \frac {\Sigma_{i=1}^N I(y_i=c_k)+\lambda} {N+K\lambda}
$$

